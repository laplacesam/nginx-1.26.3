<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>創建帳號</title>
    <link rel="stylesheet" href="As.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <style>
        /* 創建帳號頁面特殊樣式 */
        .box1 h1 {
            color: #FF6B9D; /* 標題顏色改為粉紅色 */
        }

        .box4 {
            display: flex;
            gap: 10px; /* 兩個按鈕之間的距離 */
        }

        .box4 button {
            flex: 1; /* 平均分配按鈕寬度 */
        }

        /* 返回按鈕樣式 */
        .btn-back {
            background-color: #9B9B9B !important; /* 灰色背景 */
            color: white !important;
        }

        .btn-back:hover {
            background-color: #777777 !important;
        }

        /* 註冊按鈕樣式 */
        .btn-register {
            background-color: aqua !important;
            color: rgb(208, 24, 24) !important;
        }

        .btn-register:hover {
            background-color: #00CCCC !important;
        }
    </style>
</head>
<body>

<div class="box1">
    <h1>創建帳號</h1>
    <form id="registerForm">
        <!-- 帳號輸入框 -->
        <div class="box2">
            <input type="text" id="username" placeholder="請輸入帳號" required>
            <i class='bx bxs-user'></i>
        </div>

        <!-- 密碼輸入框 -->
        <div class="box2">
            <input type="password" id="password" placeholder="請輸入密碼" required>
            <i class='bx bxs-lock-alt'></i>
        </div>

        <!-- 確認密碼輸入框 -->
        <div class="box2">
            <input type="password" id="confirmPassword" placeholder="請確認密碼" required>
            <i class='bx bxs-lock-alt'></i>
        </div>

        <!-- 電子郵件輸入框 -->
        <div class="box2">
            <input type="email" id="email" placeholder="請輸入電子郵件" required>
            <i class='bx bxs-envelope'></i>
        </div>

        <!-- 性別選擇 -->
        <div class="box3">
            男: <input type="radio" name="gender" value="男" required>
            女: <input type="radio" name="gender" value="女" required>
        </div>

        <!-- 按鈕群組 -->
        <div class="box4">
            <button type="button" class="box5 btn-back" onclick="goBackToLogin()">返回登入</button>
            <button type="submit" class="box5 btn-register">創建帳號</button>
        </div>
    </form>
</div>

<script src="app.js"></script>
<script>
    // 返回登入頁面
    function goBackToLogin() {
        window.location.href = 'index.html';
    }

    // 處理表單提交
    document.getElementById('registerForm').addEventListener('submit', async function(event) {
        event.preventDefault();

        // 獲取表單資料
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        const confirmPassword = document.getElementById('confirmPassword').value;
        const email = document.getElementById('email').value;
        const gender = document.querySelector('input[name="gender"]:checked').value;

        // 驗證密碼是否一致
        if (password !== confirmPassword) {
            alert('密碼與確認密碼不一致！');
            return;
        }

        // 驗證密碼長度
        if (password.length < 6) {
            alert('密碼長度至少為 6 個字符！');
            return;
        }

        // 準備發送的資料
        const userData = {
            username: username,
            password: password,
            email: email,
            gender: gender
        };

        try {
            // 調用 API 創建帳號 (修改為你的實際後端 URL)
            console.log('正在發送請求到: http://192.168.50.200:3000/register');
            console.log('發送的資料:', userData);

            const response = await fetch('http://192.168.50.200:3000/register', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(userData)
            });

            console.log('回應狀態:', response.status);

            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(`伺服器錯誤: ${errorData.message || response.statusText}`);
            }

            const result = await response.json();
            console.log('成功回應:', result);
            alert('帳號創建成功！');
            // 成功後導向登入頁面
            window.location.href = 'index.html';
        } catch (error) {
            console.error('錯誤詳情:', error);
            alert('創建帳號失敗: ' + error.message + '\n\n請檢查:\n1. 後端伺服器是否運行\n2. 伺服器地址是否正確\n3. 開啟瀏覽器開發工具 (F12) 查看詳細錯誤');
        }
    });
</script>

</body>
</html>
